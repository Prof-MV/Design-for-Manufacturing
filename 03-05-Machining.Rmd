## Design for Machining {#chap-machining}

```{r setup-07, include=FALSE}
## include the helpers.R file for pdf output of youtube on pdfs as a clickable link
source("R/helpers.R")
## include the required packages to make sure the page can be built.
source("R/required_packages.R")
```

### Learning Objectives {#sec:objectives-07}

By the end of this chapter, you will be able to:

1. **Apply** Design for Machining (DFM) principles to reduce manufacturing costs
2. **Calculate** spindle speed and machining time for turning operations
3. **Identify** common design features that make parts difficult to machine
4. **Implement** guidelines for tolerances, hole sizes, and feature accessibility
5. **Evaluate** machining designs for automotive, food, and defense industry applications

::: {.callout-think}
**Before You Read:** Why do you think DFM is particularly important in high-volume industries like automotive? Can you think of a part in your daily life that might have been designed poorly for machining?
:::

### Introduction to Design for Machining {#sec:machining-intro}

Design for Machining (DFM) helps engineers create parts that are easy and cost-effective to machine. DFM principles reduce manufacturing costs, improve quality, and speed up production time. In this chapter, we'll explore the fundamentals of DFM, with real-world examples from the automotive, food, and defense industries.

For a visual introduction to DFM in machining, check out these helpful YouTube videos: [Top Design Tips & Manufacturing Processes for Mechanical Engineers | DFM Guide](https://www.youtube.com/watch?v=sq3Ht-ivG5U) and [Only Real Mechanical Engineers Can Spot These Design Mistakes | CNC Machining](https://www.youtube.com/watch?v=rauL_J048sI).

```{r video-dfm-guide, echo=FALSE, results='asis'}
embed_youtube("sq3Ht-ivG5U", "Top Design Tips & Manufacturing Processes for Mechanical Engineers | DFM Guide")
```

```{r video-cnc-design-mistakes, echo=FALSE, results='asis'}
embed_youtube("rauL_J048sI", "Only Real Mechanical Engineers Can Spot These Design Mistakes | CNC Machining")
```

---

### DFM Guidelines for Machined Parts {#sec:machining-guidelines}

Before diving into calculations, let's establish the fundamental design guidelines that make parts easier and cheaper to machine.

#### Internal Corners and Fillets

Sharp internal corners are impossible to machine with rotating cutters. Always specify **fillet radii** at internal corners.

```{r fig-internal-corners, echo=FALSE, fig.cap="Internal corners require fillet radii matching available tool sizes.", fig.align='center', fig.width=10, fig.height=4}
library(ggplot2)

ggplot() +
  # BAD DESIGN (left)
  annotate("text", x = 2, y = 4.5, label = "POOR DESIGN", color = "red", fontface = "bold", size = 4) +
  geom_rect(aes(xmin = 0.5, xmax = 3.5, ymin = 1, ymax = 4), fill = "gray70", color = "black", linewidth = 1) +
  geom_rect(aes(xmin = 1.5, xmax = 3.5, ymin = 2, ymax = 3), fill = "white", color = "black", linewidth = 1) +
  annotate("text", x = 2.5, y = 2.5, label = "Sharp\nCorner", color = "red", size = 3) +
  geom_point(aes(x = 1.5, y = 2), color = "red", size = 3) +
  geom_point(aes(x = 1.5, y = 3), color = "red", size = 3) +

  # GOOD DESIGN (right)
  annotate("text", x = 7, y = 4.5, label = "GOOD DESIGN", color = "forestgreen", fontface = "bold", size = 4) +
  geom_rect(aes(xmin = 5.5, xmax = 8.5, ymin = 1, ymax = 4), fill = "gray70", color = "black", linewidth = 1) +
  # Pocket with rounded corners (approximated)
  geom_polygon(aes(x = c(6.5, 6.7, 8.5, 8.5, 6.7, 6.5),
                   y = c(2.2, 2, 2, 3, 3, 2.8)),
               fill = "white", color = "black", linewidth = 1) +
  annotate("text", x = 7.5, y = 2.5, label = "Filleted\nCorner", color = "forestgreen", size = 3) +

  # Tool illustration
  annotate("text", x = 5, y = 2.5, label = "R = Tool\nRadius", size = 3) +

  coord_fixed(ratio = 1, xlim = c(0, 9), ylim = c(0.5, 5)) +
  theme_void() +
  labs(title = "Internal Corners Must Have Fillet Radii") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 14))
```

**Guideline:** Internal fillet radius should be at least **1.5× the tool radius** to allow the tool to move smoothly without dwelling in corners.

#### Standard Hole Sizes

Specifying standard drill sizes reduces tooling costs and setup time.

| Preferred Hole Diameters (mm) |
|:------------------------------|
| 3, 4, 5, 6, 8, 10, 12, 14, 16, 18, 20, 22, 25, 28, 30 |

::: {.callout-check}
**Quick Check:** A designer specifies a 7.3 mm diameter hole. Why might this cause problems in manufacturing?
:::

#### Depth Limitations

**Hole depth:** Standard drills can reliably produce holes up to **3× diameter** deep. Deeper holes require special tooling.

**Pocket depth:** Avoid pockets deeper than **4× the tool diameter** to prevent tool deflection.

```{r fig-depth-guidelines, echo=FALSE, fig.cap="Hole and pocket depth guidelines relative to tool diameter.", fig.align='center', fig.width=10, fig.height=5}
library(ggplot2)

depth_data <- data.frame(
  feature = c("Standard Drill", "Deep Hole Drill", "End Mill Pocket", "Deep Pocket"),
  max_depth_ratio = c(3, 10, 4, 6),
  difficulty = c("Standard", "Special", "Standard", "Special")
)

ggplot(depth_data, aes(x = feature, y = max_depth_ratio, fill = difficulty)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = paste0(max_depth_ratio, "×D")), vjust = -0.5, fontface = "bold") +
  scale_fill_manual(values = c("Standard" = "forestgreen", "Special" = "coral")) +
  labs(
    title = "Maximum Depth-to-Diameter Ratios",
    x = "Feature Type",
    y = "Depth / Diameter Ratio",
    fill = "Tooling Required"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    axis.text.x = element_text(angle = 15, hjust = 1)
  ) +
  ylim(0, 12)
```

#### Wall Thickness

Thin walls deflect under cutting forces, causing chatter and poor surface finish. Minimum wall thickness depends on material and wall height.

| Material | Minimum Wall Thickness |
|:---------|:-----------------------|
| Steel | 3 mm or 0.1× height, whichever is greater |
| Aluminum | 2 mm or 0.08× height |
| Plastic | 1.5 mm |

::: {.callout-industry}
**Automotive Application:** Engine block designers must balance thermal efficiency (thin walls for better cooling) against machinability (thick enough walls to resist cutting forces during cylinder boring).
:::

---

### Theory and Calculations {#sec:machining-theory}

Design for Machining involves considering the capabilities and limitations of machining processes like milling, turning, and drilling during the design phase. Key principles include minimizing material removal, avoiding deep pockets, using standard hole sizes, and ensuring adequate tolerances.

Mathematically, one core aspect is calculating spindle speed and feed rates to optimize machining. The spindle speed \( N \) (in RPM) is given by:

\[ N = \frac{1000 \times v}{\pi \times D} \]

where \( v \) is the cutting speed (m/min), and \( D \) is the tool diameter (mm).

Machining time \( T \) for a turning operation can be:

\[ T = \frac{L}{f \times N} \]

where \( L \) is the length of cut (mm), and \( f \) is the feed rate (mm/rev).

Let's use R to perform a detailed example calculation. Suppose we're machining a shaft in the automotive industry with \( v = 150 \) m/min, \( D = 20 \) mm, \( L = 100 \) mm, and \( f = 0.2 \) mm/rev.

```{r calc-machining, echo=TRUE}
## Define parameters
v <- 150  ## cutting speed in m/min
D <- 20   ## diameter in mm
L <- 100  ## length in mm
f <- 0.2  ## feed in mm/rev

## Calculate spindle speed N
N <- (1000 * v) / (pi * D)
N

## Calculate machining time T
T <- L / (f * N)
T  ## in minutes
```

This shows a spindle speed of approximately `r round(N, 2)` RPM and machining time of about `r round(T, 3)` minutes. Adjust these parameters in your own code to see how they affect the results!

In industries like defense, where precision is critical, tolerances must be tight but achievable. Overly tight tolerances increase costs exponentially.

#### Challenge Questions

1. Derive the formula for machining time if the feed rate changes with material hardness.
2. How would you adjust the cutting speed for a food industry application using stainless steel?

### Hands-on Examples

Now, let's apply DFM to specific industries using R for analysis and visualization.

#### Automotive Industry

In automotive, DFM is used for engine components like pistons and crankshafts. Using the built-in `mtcars` dataset, we can analyze how design parameters (e.g., horsepower and weight) relate to machined parts' performance. Imagine horsepower as a proxy for engine complexity, which affects machining time.

```{r plot-auto, echo=TRUE, fig.cap="Horsepower vs Weight in Automotive Designs"}
data(mtcars)
ggplot(mtcars, aes(x = wt, y = hp)) +
  geom_point(color = "blue") +
  theme_minimal() +
  labs(title = "Horsepower vs Vehicle Weight",
       x = "Weight (1000 lbs)",
       y = "Horsepower") +
  scale_color_viridis_d()  ## Colorblind-friendly
```

This scatter plot shows that heavier vehicles often require more powerful (and thus more complex to machine) engines.




#### Food Industry

In the food industry, machined parts include conveyor rollers and mixing blades, often in food-grade stainless steel. Let's simulate data for machining costs vs. part complexity.

```{r plot-food, echo=TRUE, fig.cap="Simulated Machining Cost vs Complexity in Food Industry"}
set.seed(42)
complexity <- rnorm(50, mean = 5, sd = 2)
cost <- 10 * complexity + rnorm(50, mean = 0, sd = 5)
food_data <- data.frame(complexity, cost)

ggplot(food_data, aes(x = complexity, y = cost)) +
  geom_point(color = "green") +
  geom_smooth(method = "lm", color = "darkgreen") +
  theme_minimal() +
  labs(title = "Machining Cost vs Part Complexity",
       x = "Complexity Score",
       y = "Cost ($)") +
  scale_color_viridis_d()
```

Higher complexity leads to higher costs—DFM aims to minimize this.




#### Defense Industry

For defense, parts like aircraft fittings require high precision. Let's create an interactive plot of tolerance distributions using simulated data.

```{r plot-defense, echo=TRUE}
## Simulated tolerance data
set.seed(123)
tolerances <- rnorm(100, mean = 0, sd = 0.01)
defense_data <- data.frame(tolerances)

p <- ggplot(defense_data, aes(x = tolerances)) +
  geom_histogram(bins = 20, fill = "red", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Machining Tolerances",
       x = "Tolerance Deviation (mm)",
       y = "Frequency") +
  scale_fill_viridis_d()

ggplotly(p)
```

This interactive histogram allows you to hover over bins to see details—useful for understanding variability in defense applications.




#### Challenge Questions

1. Modify the automotive plot to filter for cars with more than 6 cylinders. What insights do you gain?
2. In the food industry simulation, add a variable for material type and replot. How does it affect costs?
3. For the defense plot, change the standard deviation to 0.005. How does tighter tolerance impact the distribution?

### Interactive Exercises

Try modifying the R code chunks above! For example, change the parameters in the machining calculation and rerun. Think critically: How would DFM principles alter a design with sharp internal corners in an automotive bracket?

---

### Tolerance and Surface Finish {#sec:machining-tolerances}

Tolerances and surface finish specifications have a dramatic impact on machining cost. The relationship is exponential, not linear.

```{r fig-tolerance-cost, echo=FALSE, fig.cap="Relative machining cost increases exponentially as tolerances tighten.", fig.align='center', fig.width=9, fig.height=5}
library(ggplot2)

# Create tolerance vs cost data
tolerance_data <- data.frame(
  tolerance_mm = c(0.5, 0.25, 0.1, 0.05, 0.025, 0.01, 0.005),
  relative_cost = c(1, 1.5, 2.5, 4, 7, 15, 30),
  process = c("Rough Turn", "Finish Turn", "Grind", "Fine Grind", "Lap", "Hone", "Super Finish")
)

ggplot(tolerance_data, aes(x = tolerance_mm, y = relative_cost)) +
  geom_line(color = "steelblue", linewidth = 1.5) +
  geom_point(color = "coral", size = 4) +
  geom_text(aes(label = process), vjust = -1, size = 3) +
  scale_x_reverse(trans = "log10") +
  labs(
    title = "Tolerance vs. Machining Cost",
    x = "Tolerance (mm) - Log Scale",
    y = "Relative Cost (Baseline = 1)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold")
  ) +
  ylim(0, 35)
```

**Design Guideline:** Only specify tight tolerances where functionally necessary. A ±0.1 mm tolerance costs approximately 2.5× more than ±0.5 mm, while ±0.01 mm costs 15× more.

::: {.callout-discussion}
**Group Discussion:** Review a mechanical assembly drawing. Identify which dimensions truly require tight tolerances (fits, sealing surfaces) and which could be relaxed without affecting function.
:::

---

### Common DFM Mistakes to Avoid {#sec:machining-mistakes}

| Mistake | Problem | Solution |
|:--------|:--------|:---------|
| Sharp internal corners | Tool cannot reach; requires EDM | Add fillet radius ≥ tool radius |
| Non-standard hole sizes | Requires custom drills; added setup | Use standard drill sizes |
| Deep narrow pockets | Tool deflection; poor finish | Limit depth to 4× tool diameter |
| Unnecessary tight tolerances | Exponential cost increase | Tolerance only critical features |
| Thin walls | Chatter; deflection | Maintain minimum wall thickness |
| Blind holes with flat bottoms | Standard drills leave points | Accept drill point or specify boring |
| Features on multiple sides | Multiple setups required | Consolidate features to fewer sides |

::: {.callout-think}
**Design Challenge:** You have a bracket that requires holes on three different faces. How could you redesign it to reduce the number of machining setups?
:::

---

### Check Your Understanding

::: {.question}
**Question 1:** What is the formula for spindle speed?

a) $N = \frac{\pi D}{1000 v}$
b) $N = \frac{1000 v}{\pi D}$
c) $N = \pi D v$
:::

::: {.answer}
**Answer: b**

The spindle speed formula is $N = \frac{1000 v}{\pi D}$ where $v$ is cutting speed in m/min and $D$ is diameter in mm.
:::

::: {.question}
**Question 2:** In which industry might hygiene requirements most affect material choice for machining?

a) Automotive
b) Food
c) Defense
:::

::: {.answer}
**Answer: b) Food**

Food processing equipment must use materials like 316 stainless steel that resist corrosion, can be sanitized, and won't contaminate products.
:::

::: {.question}
**Question 3:** True or False: Tighter tolerances always reduce manufacturing costs.
:::

::: {.answer}
**Answer: False**

Tighter tolerances dramatically *increase* manufacturing costs. Each order of magnitude improvement in tolerance can cost 3-5× more.
:::

---

### Practice Problems {#sec:machining-practice}

::: {.question}
**Problem 1:** Calculate the spindle speed and machining time for turning a 50 mm diameter shaft, 200 mm long. The material is aluminum with a recommended cutting speed of 300 m/min. Use a feed rate of 0.3 mm/rev.
:::

::: {.answer}
**Solution:**

**Spindle Speed:**
$$N = \frac{1000 \times v}{\pi \times D} = \frac{1000 \times 300}{\pi \times 50} = \frac{300000}{157.08} = 1910 \text{ RPM}$$

**Machining Time:**
$$T = \frac{L}{f \times N} = \frac{200}{0.3 \times 1910} = \frac{200}{573} = 0.35 \text{ minutes} = 21 \text{ seconds}$$
:::

::: {.question}
**Problem 2:** A designer specifies internal corners with 1 mm fillet radius in a pocket. The smallest available end mill has an 8 mm diameter (4 mm radius). Will this design work? What should the designer change?
:::

::: {.answer}
**Solution:**

No, this design will not work. The 8 mm end mill has a 4 mm radius, so the minimum internal fillet it can produce is 4 mm—not 1 mm.

**Recommendations:**
1. Increase the internal fillet radius to at least 4 mm (preferably 6 mm for smoother tool motion)
2. Or, specify that corners be finished with EDM (electrical discharge machining) at significant additional cost
3. Or, redesign to eliminate the pocket entirely
:::

::: {.question}
**Problem 3:** A part requires the following tolerances. Estimate the relative machining cost if the baseline (±0.5 mm) costs $10 per part.

- Feature A: ±0.5 mm
- Feature B: ±0.1 mm
- Feature C: ±0.025 mm
:::

::: {.answer}
**Solution:**

Using the tolerance-cost relationship:
- Feature A (±0.5 mm): 1× baseline = $10
- Feature B (±0.1 mm): ~2.5× baseline = $25
- Feature C (±0.025 mm): ~7× baseline = $70

**Total estimated machining cost: $105 per part**

Note: If Feature C could be relaxed to ±0.1 mm, the total would drop to $45—a 57% cost reduction.
:::

---

### Key Takeaways {#sec:machining-takeaways}

1. **Design with standard tools in mind:** Use standard drill sizes, avoid sharp internal corners, and limit feature depths to standard tool capabilities.

2. **Tolerances drive cost:** The relationship between tolerance and cost is exponential. Only specify tight tolerances where functionally necessary.

3. **Minimize setups:** Design parts so all features can be machined from as few orientations as possible. Each setup adds time and potential alignment error.

4. **Understand spindle speed and feed:** The formulas $N = \frac{1000v}{\pi D}$ and $T = \frac{L}{fN}$ are fundamental to predicting machining time and cost.

5. **Material matters:** Material selection affects cutting speeds, tool wear, and achievable tolerances. Harder materials require slower speeds and cost more to machine.

---

### Further Resources {#sec:machining-resources}

**Videos:**
```{r video-machining-dfm, echo=FALSE, results='asis'}
embed_youtube("sq3Ht-ivG5U", "DFM Guide for Mechanical Engineers")
```

**Reference Tables:**
- [Machinery's Handbook](https://www.industrialpress.com/machinerys-handbook/) - Comprehensive reference for speeds, feeds, and tolerances
- [Cutting Speed Charts by Material](https://www.sandvik.coromant.com/) - Sandvik Coromant technical resources

**Reading:**
- Design for Manufacturability Handbook, James G. Bralla
- Fundamentals of Modern Manufacturing, Mikell P. Groover